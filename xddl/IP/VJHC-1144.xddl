<?xml version="1.0" encoding="iso-8859-1" ?>
<!-- - Copyright 2015 Intrig -->
<!-- - See https://github.com/intrig/xenon for license. -->
<!--
   Copyright (C) 2003 - 2007 Intrig
   
   This file is protected by copyright and may be distributed and/or
   modified under the terms of the GNU General Public License version 2.0.
  
   Please contact sales@intrig.com if these licensing terms are not
   suitable for your needs.

   This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE
   WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR
   PURPOSE.
-->
<xddl name="VJHC (RFC-1144)">
  <!-- Types -->
  <!-- Fragments -->
  <fragment name="VJHC-Protocol" id="VJHC">
    <record name="Byte0" length="8" import="true">
      <field name="Unused" length="1"/>
      <field name="C" length="1"/>
      <field name="I" length="1"/>
      <field name="P" length="1"/>
      <field name="S" length="1"/>
      <field name="A" length="1"/>
      <field name="W" length="1"/>
      <field name="U" length="1"/>
    </record>
    <if expr="C">
      <field name="ConnectionNumber" length="8"/>
      <if expr="C==0">
        <field name="ConnectionNumber" length="16"/>
      </if>
    </if>
    <field name="TCPChecksum" length="8"/>
    <if expr="U">
      <field name="UrgentPointer" length="8"/>
      <if expr="U==0">
        <field name="UrgentPointer" length="16"/>
      </if>
    </if>
    <if expr="W">
      <field name="Window" length="8"/>
      <if expr="W==0">
        <field name="Window" length="16"/>
      </if>
    </if>
    <if expr="A">
      <field name="Ack" length="8"/>
      <if expr="A==0">
        <field name="Ack" length="16"/>
      </if>
    </if>
    <if expr="S">
      <field name="Sequence" length="8"/>
      <if expr="S==0">
        <field name="Sequence" length="16"/>
      </if>
    </if>
    <if expr="I">
      <field name="IP_ID" length="8"/>
      <if expr="I==0">
        <field name="IP_ID" length="16"/>
      </if>
    </if>
    <record name="Data" import="true">
      <repeat name="ByteArray">
        <field name="Char" length="8"/>
      </repeat>
    </record>
  </fragment>

  <structure>
    <fragment href="#VJHC"/>
  </structure>

</xddl>
